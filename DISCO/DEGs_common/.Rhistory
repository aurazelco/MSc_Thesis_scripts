main <- "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs/outputs/"
sub_disease <- list.dirs(main, recursive=FALSE, full.names = FALSE)
ct_order <- c(
"L2_3 EN",
"L4 EN",
"PLCH1 L4_5 EN",
"TSHZ2 L4_5 EN",
"L5 EN",
"L5_6 EN",
"L5b EN",
"L6 EN",
"pyramidal neuron",
"CXCL14 IN",
"PVALB IN",
"SST IN",
"SV2C IN",
"VIP IN",
"EC",
"fibrous astrocyte",
"protoplasmic astrocyte",
"OPC",
"oligodendrocyte",
"microglia"
)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs/02C_Conservation_func.R")
# CONSERVATION ACROSS PRIMATES
conserved <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs/extra_files/mart_export.txt",
sep = '\t',
header = TRUE,
fill = TRUE)
colnames(conserved) <- c("gene_id",
"gene_name",
"source",
"gene_GC_cont",
"Bolivian_Squirrel_Monkey",
"Chimpanzee",
"Gorilla",
"Gibbon",
"Olive_Baboon",
"Macaque")
for (sp in seq(5,10)) {
conserved[which(startsWith(conserved[,sp],"EN")),sp] <- 1
conserved[which(conserved[,sp]==''), sp] <- 0
conserved[,sp] <- as.numeric(conserved[,sp])
}
conserved <- conserved %>% distinct(gene_name, .keep_all = TRUE)
# SAGD CONSERVATION
SAGD_df <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs/extra_files/SAGD_filt.csv")
SAGD_df[,1] <- NULL
all_genes <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs/tot_genes_ct.csv")
all_genes$X <- NULL
col_factors <- c("disease", "sex", "ct")
all_genes[col_factors] <- lapply(all_genes[col_factors], as.factor)
ensembl_mat <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs/extra_files/binary_mat_all_species.csv")
colnames[ensembl_mat][1] <- "gene_name"
names(ensembl_mat)[names(ensembl_mat) == 'X'] <- "gene_name"
ConservedFractions(main, sub_disease[3], ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
ConservedFractions(main, sub_disease[3], SAGD_df, 4, "SAGD",  all_genes, ct_order)
ConservedFractions(main, sub_disease[3], ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
str(conserved)
str(SAGD_df)
str(ensembl_mat)
ConservedFractions(main, sub_disease[3], ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
source("~/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs/02C_Conservation_func.R")
ConservedFractions(main, sub_disease[3], ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
ConservedFractions(main, sub_disease[1], ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
ConservedFractions(main, sub_disease[2], ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
main <- "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/DEGs/Eze_Nowakowski_integrated_2nd_trimester/outputs/"
ct_order <- c(
"Mesenchymal",
"Neuroepithelial",
"Neuronal",
"Radial Glial",
"Other"
)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/UCSC/DEGs/02C_Conservation_func.R")
ensembl_mat <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs/extra_files/binary_mat_all_species.csv")
names(ensembl_mat)[names(ensembl_mat) == 'X'] <- "gene_name"
all_genes <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/DEGs/Eze_Nowakowski_integrated_2nd_trimester/tot_genes_ct.csv")
all_genes$X <- NULL
col_factors <- c("sex", "ct")
all_genes[col_factors] <- lapply(all_genes[col_factors], as.factor)
ConservedFractions(main, ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
main_local <- "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/DEGs/Velmeshev_2022_0_1_years/outputs/"
ct_order <- c(
"Dorsal progenitors",
"Ventral progenitors",
"Excitatory neurons",
"Interneurons",
"OPCs",
"Oligodendrocytes",
"Astrocytes",
"Microglia",
"Vascular cells",
"Unknown"
)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/UCSC/DEGs/02C_Conservation_func.R")
ensembl_mat <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs/extra_files/binary_mat_all_species.csv")
names(ensembl_mat)[names(ensembl_mat) == 'X'] <- "gene_name"
all_genes <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/DEGs/Velmeshev_2022_0_1_years/tot_genes_ct_Velmeshev_2022_0_1_years.csv")
all_genes$X <- NULL
all_genes$sex <- str_replace_all(all_genes$sex, c("Female"="F", "Male"="M"))
col_factors <- c("sex", "ct")
all_genes[col_factors] <- lapply(all_genes[col_factors], as.factor)
C
ConservedFractions(main_local, ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
main_local <- "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/DEGs/Velmeshev_2022_1_2_years/outputs/"
ct_order <- c(
"Dorsal progenitors",
"Ventral progenitors",
"Excitatory neurons",
"Interneurons",
"OPCs",
"Oligodendrocytes",
"Astrocytes",
"Microglia",
"Vascular cells",
"Unknown"
)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/UCSC/DEGs/02C_Conservation_func.R")
ensembl_mat <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs/extra_files/binary_mat_all_species.csv")
names(ensembl_mat)[names(ensembl_mat) == 'X'] <- "gene_name"
# all genes commonly expressed in the cts
all_genes <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/DEGs/Velmeshev_2022_1_2_years/tot_genes_ct_Velmeshev_2022_1_2_years.csv")
all_genes$X <- NULL
all_genes$sex <- str_replace_all(all_genes$sex, c("Female"="F", "Male"="M"))
col_factors <- c("sex", "ct")
all_genes[col_factors] <- lapply(all_genes[col_factors], as.factor)
ConservedFractions(main_local, ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
main_local <- "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/DEGs/Velmeshev_2022_2_4_years/outputs/"
ct_order <- c(
"Dorsal progenitors",
"Ventral progenitors",
"Excitatory neurons",
"Interneurons",
"OPCs",
"Oligodendrocytes",
"Astrocytes",
"Microglia",
"Vascular cells",
"Unknown"
)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/UCSC/DEGs/02C_Conservation_func.R")
ensembl_mat <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs/extra_files/binary_mat_all_species.csv")
names(ensembl_mat)[names(ensembl_mat) == 'X'] <- "gene_name"
# all genes commonly expressed in the cts
all_genes <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/DEGs/Velmeshev_2022_2_4_years/tot_genes_ct_Velmeshev_2022_2_4_years.csv")
all_genes$X <- NULL
all_genes$sex <- str_replace_all(all_genes$sex, c("Female"="F", "Male"="M"))
col_factors <- c("sex", "ct")
all_genes[col_factors] <- lapply(all_genes[col_factors], as.factor)
ConservedFractions(main, ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
ConservedFractions(main_local, ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
main <- "/Home/ii/auraz/data/UCSC/outputs/DEGs/Velmeshev_2022_2nd_trimester/outputs/"
main_local <- "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/DEGs/Velmeshev_2022_2nd_trimester/outputs/"
ct_order <- c(
"Dorsal progenitors",
"Ventral progenitors",
"Excitatory neurons",
"Interneurons",
"OPCs",
"Oligodendrocytes",
"Astrocytes",
"Microglia",
"Vascular cells",
"Unknown"
)
source("/Home/ii/auraz/scripts/DEGs/02C_Conservation_func.R")
main_local <- "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/DEGs/Velmeshev_2022_3rd_trimester/outputs/"
ct_order <- c(
"Dorsal progenitors",
"Ventral progenitors",
"Excitatory neurons",
"Interneurons",
"OPCs",
"Oligodendrocytes",
"Astrocytes",
"Microglia",
"Vascular cells",
"Unknown"
)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/UCSC/DEGs/02C_Conservation_func.R")
ensembl_mat <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs/extra_files/binary_mat_all_species.csv")
names(ensembl_mat)[names(ensembl_mat) == 'X'] <- "gene_name"
# all genes commonly expressed in the cts
all_genes <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/DEGs/Velmeshev_2022_3rd_trimester/tot_genes_ct_Velmeshev_2022_3rd_trimester.csv")
all_genes$X <- NULL
all_genes$sex <- str_replace_all(all_genes$sex, c("Female"="F", "Male"="M"))
col_factors <- c("sex", "ct")
all_genes[col_factors] <- lapply(all_genes[col_factors], as.factor)
ConservedFractions(main_local, ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
main_local <- "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/DEGs/Velmeshev_2022_Adult/outputs/"
ct_order <- c(
"Dorsal progenitors",
"Ventral progenitors",
"Excitatory neurons",
"Interneurons",
"OPCs",
"Oligodendrocytes",
"Astrocytes",
"Microglia",
"Vascular cells",
"Unknown"
)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/UCSC/DEGs/02C_Conservation_func.R")
ensembl_mat <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs/extra_files/binary_mat_all_species.csv")
names(ensembl_mat)[names(ensembl_mat) == 'X'] <- "gene_name"
# all genes commonly expressed in the cts
all_genes <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/DEGs/Velmeshev_2022_Adult/tot_genes_ct_Velmeshev_2022_Adult.csv")
all_genes$X <- NULL
all_genes$sex <- str_replace_all(all_genes$sex, c("Female"="F", "Male"="M"))
col_factors <- c("sex", "ct")
all_genes[col_factors] <- lapply(all_genes[col_factors], as.factor)
ConservedFractions(main_local, ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
