"oligodendrocyte" =  "Oligodendrocyte",
"OPC" = "Oligodendrocyte",
"PLCH1 L4_5 EN" = "EN",
"protoplasmic astrocyte" = "astrocyte",
"PVALB IN"  = "IN",
"pyramidal neuron"  = "EN",
"SST IN" = "IN",
"SV2C IN"  = "IN",
"TSHZ2 L4_5 EN" = "EN",
"VIP IN" = "IN")
extra_path <- "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/"
# NORMAL
PlotCMresults(main, sub_disease[2],
extra_path,
ct_list, data_ct, ct_order)
# AD
PlotCMresults(main, sub_disease[1],
extra_path,
ct_list, data_ct, ct_order)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/01C_num_chr_func.R")
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/02A_HyperGeom_func.R")
# as used in 02A_HyperGeom
X_chr_genes <- 1848
Y_chr_genes <- 431
tot_genes <- 20000
num_chr_genes <- list("X" = X_chr_genes, "Y" = Y_chr_genes, "Autosome" = (tot_genes - X_chr_genes - Y_chr_genes))
# NORMAL
SexChr2(main, sub_disease[2], tot_genes, X_chr_genes, Y_chr_genes)
PlotNumChr(main, sub_disease[2], num_chr_genes, ct_order, T)
# AD
SexChr2(main, sub_disease[1], tot_genes, X_chr_genes, Y_chr_genes)
PlotNumChr(main, sub_disease[1], num_chr_genes, ct_order, T)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/02B_ARE_ERE_func.R")
ARE <- read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/AREsitesHuman.xlsx",
skip=1)
colnames(ARE) <- c("fullsites", "halfsites")
ERE <- read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/Hs_allEREs.xls")
EREgene <- ERE$`Hs Gene Name`
# NORMAL
AnalysisARE_ERE(main, sub_disease[2], ARE, EREgene, ct_order)
# AD
AnalysisARE_ERE(main, sub_disease[1], ARE, EREgene, ct_order)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/02C_Conservation_func.R")
# CONSERVATION ACROSS PRIMATES
conserved <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/mart_export.txt",
sep = '\t',
header = TRUE,
fill = TRUE)
colnames(conserved) <- c("gene_id",
"gene_name",
"source",
"gene_GC_cont",
"Bolivian_Squirrel_Monkey",
"Chimpanzee",
"Gorilla",
"Gibbon",
"Olive_Baboon",
"Macaque")
for (sp in seq(5,10)) {
conserved[which(startsWith(conserved[,sp],"EN")),sp] <- 1
conserved[which(conserved[,sp]==''), sp] <- 0
conserved[,sp] <- as.numeric(conserved[,sp])
}
conserved <- conserved %>% distinct(gene_name, .keep_all = TRUE)
SAGD_df <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/SAGD_filt.csv")
SAGD_df[,1] <- NULL
# ENSEMBL
ensembl_mat <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/binary_mat_all_species.csv")
names(ensembl_mat)[names(ensembl_mat) == 'X'] <- "gene_name"
all_genes <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/tot_genes_ct.csv")
all_genes$X <- NULL
all_genes <- subset(all_genes, proj==project_id)
all_genes$proj <- NULL
col_factors <- c("disease", "sex", "ct")
all_genes[col_factors] <- lapply(all_genes[col_factors], as.factor)
# NORMAL
ConservedFractions(main, sub_disease[2], conserved, 4, "Primates", all_genes, ct_order)
ConservedFractions(main, sub_disease[2], SAGD_df, 4, "SAGD",  all_genes, ct_order)
ConservedFractions(main, sub_disease[2], ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
ConservedFractions(main, sub_disease[2], ensembl_mat, 100, "ENSEMBL",  all_genes, ct_order)
# AD
ConservedFractions(main, sub_disease[1], conserved, 4, "Primates",  all_genes, ct_order)
ConservedFractions(main, sub_disease[1], SAGD_df, 4, "SAGD",  all_genes, ct_order)
ConservedFractions(main, sub_disease[1], ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
ConservedFractions(main, sub_disease[1], ensembl_mat, 100, "ENSEMBL",  all_genes, ct_order)
project_id
project_id <- "GSE174367"
main <- paste0("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/", project_id, "/")
sub_disease <- list.dirs(main, recursive=FALSE, full.names = FALSE)
ct_order <- c(
"L2_3 EN",
"L4 EN",
"PLCH1 L4_5 EN",
"TSHZ2 L4_5 EN",
"L5 EN",
"L5_6 EN",
"L5b EN",
"L6 EN",
"pyramidal neuron",
"CXCL14 IN",
"PVALB IN",
"SST IN",
"SV2C IN",
"VIP IN",
"EC",
"fibrous astrocyte",
"protoplasmic astrocyte",
"OPC",
"oligodendrocyte",
"microglia"
)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/01B_plot_num_genes_func.R")
# QC parameters
pval_thresh <- 0.05
FC_thresh <- 1.2
min_num_thresh <- 10
# NORMAL
CountDEG(main, sub_disease[2], pval_thresh, FC_thresh, ct_order, min_num_thresh)
# AD
CountDEG(main, sub_disease[1], pval_thresh, FC_thresh, ct_order, min_num_thresh)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/01C_num_chr_func.R")
# NORMAL
chr_normal <- ProcessCt(main, sub_disease[2])
ExtractSharedGenes(main, sub_disease[2], chr_normal)
PlotGeneralHeatmap(main, sub_disease[2], chr_normal, ct_order)
PlotSexHmp(main, sub_disease[2], chr_normal, ct_order)
# AD
chr_ad <- ProcessCt(main, sub_disease[1])
ExtractSharedGenes(main, sub_disease[1], chr_ad)
PlotGeneralHeatmap(main, sub_disease[1], chr_ad, ct_order)
PlotSexHmp(main, sub_disease[1], chr_ad, ct_order)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/01D_Xpar1,2_func.R")
Xpar1 <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/Xpar1.csv",
skip = 1)
Xpar1_list <- Xpar1$Approved.symbol
Xpar2 <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/Xpar2.csv",
skip = 1)
Xpar2_list <- Xpar2$Approved.symbol
# NORMAL
XparCt(main, sub_disease[2], Xpar1_list, Xpar2_list, ct_order)
# AD
XparCt(main, sub_disease[1], Xpar1_list, Xpar2_list, ct_order)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/01E_CellMarker_func.R")
ct_list <- c(
"Astrocyte" ="astrocyte",
"B cell" = "B",
"Endothelial cell" = "EC",
"Glial cell" = "Glia" ,
"Glutamatergic neuron" = "EN",
"Interstitial cell" = "IC",
"Lake et al.Science.Ex1" = "EN",
"Lake et al.Science.Ex2" = "EN",
"Lake et al.Science.Ex3" = "EN",
"Lake et al.Science.Ex4" = "EN",
"Lake et al.Science.Ex5" = "EN",
"Lake et al.Science.Ex6" = "EN",
"Lake et al.Science.Ex7" = "EN",
"Lake et al.Science.Ex8" = "EN",
"Lake et al.Science.In1" = "IN",
"Lake et al.Science.In2" = "IN",
"Lake et al.Science.In3" = "IN",
"Lake et al.Science.In4" = "IN",
"Lake et al.Science.In5" = "IN",
"Lake et al.Science.In6" = "IN",
"Lake et al.Science.In7" = "IN",
"Lake et al.Science.In8" = "IN",
"M1 macrophage" = "Macrophage",
"M2 macrophage" = "Macrophage",
"Macrophage"= "Macrophage",
"Microglial cell" = "Microglia",
"Neural progenitor cell" = "NPC",
"Neural stem cell" = "NSC",
"Neuron" = "Neuron",
"Neutrophil" = "Neutrophil",
"Oligodendrocyte" = "Oligodendrocyte",
"Oligodendrocyte precursor cell" = "Oligodendrocyte",
"Oligodendrocyte progenitor cell" = "Oligodendrocyte",
"Pericyte"  = "Pericyte",
"Purkinje cell" = "Neuron",
"Stem cell" =    "Stem cell",
"T cell"  = "T",
"T helper2 (Th2) cell" = "T"
)
data_ct <- c("CXCL14 IN" = "IN",
"EC" = "EC",
"fibrous astrocyte"  = "astrocyte",
"L2_3 EN" = "EN",
"L4 EN" = "EN",
"L5 EN" = "EN",
"L5_6 EN" = "EN",
"L5b EN" = "EN",
"L6 EN" = "EN",
"microglia" = "Microglia",
"oligodendrocyte" =  "Oligodendrocyte",
"OPC" = "Oligodendrocyte",
"PLCH1 L4_5 EN" = "EN",
"protoplasmic astrocyte" = "astrocyte",
"PVALB IN"  = "IN",
"pyramidal neuron"  = "EN",
"SST IN" = "IN",
"SV2C IN"  = "IN",
"TSHZ2 L4_5 EN" = "EN",
"VIP IN" = "IN")
extra_path <- "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/"
# NORMAL
PlotCMresults(main, sub_disease[2],
extra_path,
ct_list, data_ct, ct_order)
# AD
PlotCMresults(main, sub_disease[1],
extra_path,
ct_list, data_ct, ct_order)
####### 02A_HyperGeom.R
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/01C_num_chr_func.R")
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/02A_HyperGeom_func.R")
# as used in 02A_HyperGeom
X_chr_genes <- 1848
Y_chr_genes <- 431
tot_genes <- 20000
num_chr_genes <- list("X" = X_chr_genes, "Y" = Y_chr_genes, "Autosome" = (tot_genes - X_chr_genes - Y_chr_genes))
# NORMAL
SexChr2(main, sub_disease[2], tot_genes, X_chr_genes, Y_chr_genes)
PlotNumChr(main, sub_disease[2], num_chr_genes, ct_order, T)
# AD
SexChr2(main, sub_disease[1], tot_genes, X_chr_genes, Y_chr_genes)
PlotNumChr(main, sub_disease[1], num_chr_genes, ct_order, T)
####### 02B_ARE_ERE.R
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/02B_ARE_ERE_func.R")
ARE <- read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/AREsitesHuman.xlsx",
skip=1)
colnames(ARE) <- c("fullsites", "halfsites")
ERE <- read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/Hs_allEREs.xls")
EREgene <- ERE$`Hs Gene Name`
# NORMAL
AnalysisARE_ERE(main, sub_disease[2], ARE, EREgene, ct_order)
# AD
AnalysisARE_ERE(main, sub_disease[1], ARE, EREgene, ct_order)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/02C_Conservation_func.R")
# CONSERVATION ACROSS PRIMATES
conserved <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/mart_export.txt",
sep = '\t',
header = TRUE,
fill = TRUE)
colnames(conserved) <- c("gene_id",
"gene_name",
"source",
"gene_GC_cont",
"Bolivian_Squirrel_Monkey",
"Chimpanzee",
"Gorilla",
"Gibbon",
"Olive_Baboon",
"Macaque")
for (sp in seq(5,10)) {
conserved[which(startsWith(conserved[,sp],"EN")),sp] <- 1
conserved[which(conserved[,sp]==''), sp] <- 0
conserved[,sp] <- as.numeric(conserved[,sp])
}
conserved <- conserved %>% distinct(gene_name, .keep_all = TRUE)
SAGD_df <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/SAGD_filt.csv")
SAGD_df[,1] <- NULL
ensembl_mat <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/binary_mat_all_species.csv")
names(ensembl_mat)[names(ensembl_mat) == 'X'] <- "gene_name"
# Read all DEGs from healthy patients, regardless of the sex
# all genes commonly expressed in the cts
all_genes <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/tot_genes_ct.csv")
all_genes$X <- NULL
all_genes <- subset(all_genes, proj==project_id)
all_genes$proj <- NULL
col_factors <- c("disease", "sex", "ct")
all_genes[col_factors] <- lapply(all_genes[col_factors], as.factor)
# NORMAL
ConservedFractions(main, sub_disease[2], conserved, 4, "Primates", all_genes, ct_order)
ConservedFractions(main, sub_disease[2], SAGD_df, 4, "SAGD",  all_genes, ct_order)
ConservedFractions(main, sub_disease[2], ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
ConservedFractions(main, sub_disease[2], ensembl_mat, 100, "ENSEMBL",  all_genes, ct_order)
# AD
ConservedFractions(main, sub_disease[1], conserved, 4, "Primates",  all_genes, ct_order)
ConservedFractions(main, sub_disease[1], SAGD_df, 4, "SAGD",  all_genes, ct_order)
ConservedFractions(main, sub_disease[1], ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
ConservedFractions(main, sub_disease[1], ensembl_mat, 100, "ENSEMBL",  all_genes, ct_order)
project_id <- "PRJNA544731"
main <- paste0("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj/", project_id, "/")
sub_disease <- list.dirs(main, recursive=FALSE, full.names = FALSE)
ct_order <- c(
"L2_3 EN",
"L4 EN",
"PLCH1 L4_5 EN",
"TSHZ2 L4_5 EN",
"L5 EN",
"L5_6 EN",
"L5b EN",
"L6 EN",
"pyramidal neuron",
"CXCL14 IN",
"PVALB IN",
"SST IN",
"SV2C IN",
"VIP IN",
"EC",
"fibrous astrocyte",
"protoplasmic astrocyte",
"OPC",
"oligodendrocyte",
"microglia"
)
####### 01B_plot_num_genes.R
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects/01B_plot_num_genes_func.R")
# QC parameters
pval_thresh <- 0.05
FC_thresh <- 1.2
min_num_thresh <- 10
# NORMAL
CountDEG(main, sub_disease[2], pval_thresh, FC_thresh, ct_order, min_num_thresh)
project_id <- "PRJNA544731"
main <- paste0("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/", project_id, "/")
sub_disease <- list.dirs(main, recursive=FALSE, full.names = FALSE)
ct_order <- c(
"L2_3 EN",
"L4 EN",
"PLCH1 L4_5 EN",
"TSHZ2 L4_5 EN",
"L5 EN",
"L5_6 EN",
"L5b EN",
"L6 EN",
"pyramidal neuron",
"CXCL14 IN",
"PVALB IN",
"SST IN",
"SV2C IN",
"VIP IN",
"EC",
"fibrous astrocyte",
"protoplasmic astrocyte",
"OPC",
"oligodendrocyte",
"microglia"
)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/01B_plot_num_genes_func.R")
# QC parameters
pval_thresh <- 0.05
FC_thresh <- 1.2
min_num_thresh <- 10
# NORMAL
CountDEG(main, sub_disease[2], pval_thresh, FC_thresh, ct_order, min_num_thresh)
# MS
CountDEG(main, sub_disease[1], pval_thresh, FC_thresh, ct_order, min_num_thresh)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/01C_num_chr_func.R")
# NORMAL
chr_normal <- ProcessCt(main, sub_disease[2])
ExtractSharedGenes(main, sub_disease[2], chr_normal)
PlotGeneralHeatmap(main, sub_disease[2], chr_normal, ct_order)
PlotSexHmp(main, sub_disease[2], chr_normal, ct_order)
# MS
chr_ms <- ProcessCt(main, sub_disease[1])
ExtractSharedGenes(main, sub_disease[1], chr_ms)
PlotGeneralHeatmap(main, sub_disease[1], chr_ms, ct_order)
PlotSexHmp(main, sub_disease[1], chr_ms, ct_order)
####### 01D_Xpar1,2.R
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/01D_Xpar1,2_func.R")
Xpar1 <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/Xpar1.csv",
skip = 1)
Xpar1_list <- Xpar1$Approved.symbol
Xpar2 <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/Xpar2.csv",
skip = 1)
Xpar2_list <- Xpar2$Approved.symbol
# NORMAL
XparCt(main, sub_disease[2], Xpar1_list, Xpar2_list, ct_order)
# MS
XparCt(main, sub_disease[1], Xpar1_list, Xpar2_list, ct_order)
####### 01E_CellMarker.R
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/01E_CellMarker_func.R")
ct_list <- c(
"Astrocyte" ="astrocyte",
"B cell" = "B",
"Endothelial cell" = "EC",
"Glial cell" = "Glia" ,
"Glutamatergic neuron" = "EN",
"Interstitial cell" = "IC",
"Lake et al.Science.Ex1" = "EN",
"Lake et al.Science.Ex2" = "EN",
"Lake et al.Science.Ex3" = "EN",
"Lake et al.Science.Ex4" = "EN",
"Lake et al.Science.Ex5" = "EN",
"Lake et al.Science.Ex6" = "EN",
"Lake et al.Science.Ex7" = "EN",
"Lake et al.Science.Ex8" = "EN",
"Lake et al.Science.In1" = "IN",
"Lake et al.Science.In2" = "IN",
"Lake et al.Science.In3" = "IN",
"Lake et al.Science.In4" = "IN",
"Lake et al.Science.In5" = "IN",
"Lake et al.Science.In6" = "IN",
"Lake et al.Science.In7" = "IN",
"Lake et al.Science.In8" = "IN",
"M1 macrophage" = "Macrophage",
"M2 macrophage" = "Macrophage",
"Macrophage"= "Macrophage",
"Microglial cell" = "Microglia",
"Neural progenitor cell" = "NPC",
"Neural stem cell" = "NSC",
"Neuron" = "Neuron",
"Neutrophil" = "Neutrophil",
"Oligodendrocyte" = "Oligodendrocyte",
"Oligodendrocyte precursor cell" = "Oligodendrocyte",
"Oligodendrocyte progenitor cell" = "Oligodendrocyte",
"Pericyte"  = "Pericyte",
"Purkinje cell" = "Neuron",
"Stem cell" =    "Stem cell",
"T cell"  = "T",
"T helper2 (Th2) cell" = "T"
)
data_ct <- c("CXCL14 IN" = "IN",
"EC" = "EC",
"fibrous astrocyte"  = "astrocyte",
"L2_3 EN" = "EN",
"L4 EN" = "EN",
"L5 EN" = "EN",
"L5_6 EN" = "EN",
"L5b EN" = "EN",
"L6 EN" = "EN",
"microglia" = "Microglia",
"oligodendrocyte" =  "Oligodendrocyte",
"OPC" = "Oligodendrocyte",
"PLCH1 L4_5 EN" = "EN",
"protoplasmic astrocyte" = "astrocyte",
"PVALB IN"  = "IN",
"pyramidal neuron"  = "EN",
"SST IN" = "IN",
"SV2C IN"  = "IN",
"TSHZ2 L4_5 EN" = "EN",
"VIP IN" = "IN")
extra_path <- "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/"
# NORMAL
PlotCMresults(main, sub_disease[2],
extra_path,
ct_list, data_ct, ct_order)
# MS
PlotCMresults(main, sub_disease[1],
extra_path,
ct_list, data_ct, ct_order)
####### 02A_HyperGeom.R
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/01C_num_chr_func.R")
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/02A_HyperGeom_func.R")
# as used in 02A_HyperGeom
X_chr_genes <- 1848
Y_chr_genes <- 431
tot_genes <- 20000
num_chr_genes <- list("X" = X_chr_genes, "Y" = Y_chr_genes, "Autosome" = (tot_genes - X_chr_genes - Y_chr_genes))
# NORMAL
SexChr2(main, sub_disease[2], tot_genes, X_chr_genes, Y_chr_genes)
PlotNumChr(main, sub_disease[2], num_chr_genes, ct_order, T)
# MS
SexChr2(main, sub_disease[1], tot_genes, X_chr_genes, Y_chr_genes)
PlotNumChr(main, sub_disease[1], num_chr_genes, ct_order, T)
####### 02B_ARE_ERE.R
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/02B_ARE_ERE_func.R")
ARE <- read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/AREsitesHuman.xlsx",
skip=1)
colnames(ARE) <- c("fullsites", "halfsites")
ERE <- read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/Hs_allEREs.xls")
EREgene <- ERE$`Hs Gene Name`
# NORMAL
AnalysisARE_ERE(main, sub_disease[2], ARE, EREgene, ct_order)
# MS
AnalysisARE_ERE(main, sub_disease[1], ARE, EREgene, ct_order)
source("/Users/aurazelco/Desktop/Lund_MSc/Thesis/scripts/DISCO/DEGs_individual_projects_adjust_pval/02C_Conservation_func.R")
# CONSERVATION ACROSS PRIMATES
conserved <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/mart_export.txt",
sep = '\t',
header = TRUE,
fill = TRUE)
colnames(conserved) <- c("gene_id",
"gene_name",
"source",
"gene_GC_cont",
"Bolivian_Squirrel_Monkey",
"Chimpanzee",
"Gorilla",
"Gibbon",
"Olive_Baboon",
"Macaque")
for (sp in seq(5,10)) {
conserved[which(startsWith(conserved[,sp],"EN")),sp] <- 1
conserved[which(conserved[,sp]==''), sp] <- 0
conserved[,sp] <- as.numeric(conserved[,sp])
}
conserved <- conserved %>% distinct(gene_name, .keep_all = TRUE)
SAGD_df <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/SAGD_filt.csv")
SAGD_df[,1] <- NULL
# ENSEMBL
ensembl_mat <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/extra_files/binary_mat_all_species.csv")
names(ensembl_mat)[names(ensembl_mat) == 'X'] <- "gene_name"
# Read all DEGs from healthy patients, regardless of the sex
# all genes commonly expressed in the cts
all_genes <- read.csv("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/DISCOv1.0/DEGs_proj_adjust_pval/tot_genes_ct.csv")
all_genes$X <- NULL
all_genes <- subset(all_genes, proj==project_id)
all_genes$proj <- NULL
col_factors <- c("disease", "sex", "ct")
all_genes[col_factors] <- lapply(all_genes[col_factors], as.factor)
# NORMAL
ConservedFractions(main, sub_disease[2], conserved, 4, "Primates", all_genes, ct_order)
ConservedFractions(main, sub_disease[2], SAGD_df, 4, "SAGD",  all_genes, ct_order)
ConservedFractions(main, sub_disease[2], ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
ConservedFractions(main, sub_disease[2], ensembl_mat, 100, "ENSEMBL",  all_genes, ct_order)
# MS
ConservedFractions(main, sub_disease[1], conserved, 4, "Primates",  all_genes, ct_order)
ConservedFractions(main, sub_disease[1], SAGD_df, 4, "SAGD",  all_genes, ct_order)
ConservedFractions(main, sub_disease[1], ensembl_mat, 4, "ENSEMBL",  all_genes, ct_order)
ConservedFractions(main, sub_disease[1], ensembl_mat, 100, "ENSEMBL",  all_genes, ct_order)
