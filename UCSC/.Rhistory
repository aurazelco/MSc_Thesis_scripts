unique(all_meta_files[[1]]$Samples)
all_meta_files[[1]]$Samples <- stri_replace_last_fixed(all_meta_files[[1]]$Cell.Name, "_", "")
(all_meta_files[[1]])[1:10,]
unique(all_meta_files[[1]]$Samples)
all_meta_files[[1]]$Samples <- stri_replace_last_fixed(all_meta_files[[1]]$Samples, "_", ".")
unique(all_meta_files[[1]]$Samples)
all_meta_files[[1]]$Samples <- gsub("\\..*", "", all_meta_files[[1]]$Samples)
unique(all_meta_files[[1]]$Samples)
all_meta_files[[1]]$Samples <- str_replace_all(all_meta_files[[1]]$Samples, c("_motor"="", "_PFC"="", "_V1"=""))
unique(all_meta_files[[1]]$Samples)
all_meta_files[[1]]$Samples <- str_replace_all(all_meta_files[[1]]$Samples, "gw", "GW")
unique(all_meta_files[[1]]$Samples)
length(unique(all_meta_files[[1]]$Samples))
age <- vector(age, paste(unique(all_meta_files[[1]]$Age),collapse=", "))
paste(unique(all_meta_files[[1]]$Age),collapse=", ")
age <- c(age, paste(unique(all_meta_files[[1]]$Age),collapse=", "))
cell_type <- c(cell_type, paste(unique(all_meta_files[[1]]$ConsensusCellType...Final),collapse=", "))
area <- c(area, paste(unique(all_meta_files[[1]]$Area),collapse=", "))
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[1]]$Samples)))
colnames(all_meta_files[[2]])
unique(all_meta_files[[2]]$age)
unique(all_meta_files[[2]]$individual)
unique(all_meta_files[[2]]$cell_name)
unique(all_meta_files[[2]]$structure)
unique(all_meta_files[[2]]$area)
unique(all_meta_files[[2]]$cell_class)
unique(all_meta_files[[2]]$cell_type)
unique(all_meta_files[[2]]$cell_cluster)
unique(all_meta_files[[2]]$age)
age <- c(age, paste(unique(all_meta_files[[2]]$age),collapse=", GW"))
cell_type <- c(cell_type, paste(unique(all_meta_files[[2]]$cell_type),collapse=", "))
area <- c(area, paste(unique(all_meta_files[[2]]$area),collapse=", "))
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[2]]$individual)))
age <- vector()
cell_type <- vector()
area <- vector()
sex  <- vector()
num_samples <- vector()
age <- c(age, paste(unique(all_meta_files[[1]]$Age),collapse=", "))
cell_type <- c(cell_type, paste(unique(all_meta_files[[1]]$ConsensusCellType...Final),collapse=", "))
area <- c(area, paste(unique(all_meta_files[[1]]$Area),collapse=", "))
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[1]]$Samples)))
all_meta_files[[2]]$age <- paste0("GW", all_meta_files[[2]]$age)
unique(all_meta_files[[2]]$age)
age <- c(age, paste(unique(all_meta_files[[2]]$age),collapse=", "))
cell_type <- c(cell_type, paste(unique(all_meta_files[[2]]$cell_type),collapse=", "))
area <- c(area, paste(unique(all_meta_files[[2]]$area),collapse=", "))
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[2]]$individual)))
names(all_meta_files)
colnames(all_meta_files[[3]])
unique(all_meta_files[[3]]$age)
unique(all_meta_files[[3]]$GEO_Sample_age)
unique(all_meta_files[[3]]$biosample_source_life_stage)
unique(all_meta_files[[3]]$sample_category)
unique(all_meta_files[[3]]$biosample_cell_type)
unique(all_meta_files[[3]]$biosample_source_gender)
all_meta_files[[3]][which(all_meta_files[[3]]$biosample_source_life_stage=="embryo"), "biosample_source_gender"]
unique(all_meta_files[[3]]$X)
unique(all_meta_files[[3]]$UMI.Count)
age <- c(age, paste(unique(all_meta_files[[3]]$GEO_Sample_age),collapse=", "))
cell_type <- c(cell_type, paste(unique(all_meta_files[[3]]$biosample_cell_type),collapse=", "))
area <- c(area, paste(unique(all_meta_files[[3]]$sample_category),collapse=", "))
sex  <- c(sex, "no data")
num_samples <- c(num_samples, "no data")
colnames(all_meta_files[[4]])
unique(all_meta_files[[4]]$Cell)
unique(all_meta_files[[4]]$Cell)
unique(all_meta_files[[4]]$Individual)
unique(all_meta_files[[4]]$Age_.Carnegie_Stage.)
all_meta_files[[4]]$Age_.Carnegie_Stage. <- paste0("GW", all_meta_files[[4]]$Age_.Carnegie_Stage.)
unique(all_meta_files[[4]]$Area)
unique(all_meta_files[[4]]$Area_As_Annotated)
unique(all_meta_files[[4]]$V1)
unique(all_meta_files[[4]]$Cluster)
colnames(all_meta_files[[4]])
age <- c(age, paste(unique(all_meta_files[[4]]$Age_.Carnegie_Stage.),collapse=", "))
cell_type <- c(cell_type, "no data")
area <- c(area, paste(unique(all_meta_files[[4]]$Area_As_Annotated),collapse=", "))
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[4]]$Individual)))
colnames(all_meta_files[[5]])
unique(all_meta_files[[5]]$sample)
unique(all_meta_files[[5]]$cellId)
unique(all_meta_files[[5]]$donor)
unique(all_meta_files[[5]]$stage)
unique(all_meta_files[[5]]$organ)
unique(all_meta_files[[5]]$sample)
unique(all_meta_files[[5]]$batch)
unique(all_meta_files[[5]]$stage)
unique(all_meta_files[[5]]$cluster)
unique(all_meta_files[[5]]$cell_type)
unique(all_meta_files[[5]][which(all_meta_files[[5]]$sample=="FetalBrain"), "cell_type"])
unique(all_meta_files[[5]][which(all_meta_files[[5]]$sample=="FetalBrain"), "sample"])
unique(all_meta_files[[5]][which(all_meta_files[[5]]$organ=="Brain"), "sample"])
unique(all_meta_files[[5]][which(all_meta_files[[5]]$donor=="Donor1"), ])
unique(all_meta_files[[5]][which(all_meta_files[[5]]$donor=="Donor2"), ])
unique(all_meta_files[[5]][which(all_meta_files[[5]]$organ=="Brain"), "donor"])
age <- c(age, "GW11, GW12, GW13") # from suppl information meta_Han_2020_suppl.xlsx
cell_type <- c(cell_type,  paste(unique(all_meta_files[[5]][which(all_meta_files[[5]]$sample=="FetalBrain"), "cell_type"]),collapse=", "))
area <- c(area, paste(unique(all_meta_files[[5]]$sample),collapse=", "))
sex  <- c(sex, "2M 2F")
num_samples <- c(num_samples, length(unique(all_meta_files[[5]][which(all_meta_files[[5]]$organ=="Brain"), "donor"])))
colnames(all_meta_files[[6]])
unique(all_meta_files[[5]]$cellId)
unique(all_meta_files[[6]]$Study_ID)
unique(all_meta_files[[6]]$Tumor.Normal.Classification)
unique(all_meta_files[[6]]$Sample_ID)
unique(all_meta_files[[6]]$Cell.Type.Assignment)
unique(all_meta_files[[6]]$Celltype)
unique(all_meta_files[[6]][which(all_meta_files[[6]]$Tumor.Normal.Classification=="Normal"), "Cell.Type.Assignment"])
unique(all_meta_files[[6]][which(all_meta_files[[6]]$Tumor.Normal.Classification=="Normal"), "Study_ID"])
age <- c(age, "no data")
cell_type <- c(cell_type, paste(unique(all_meta_files[[6]][which(all_meta_files[[6]]$Tumor.Normal.Classification=="Normal"), "Cell.Type.Assignment"]),collapse=", "))
area <- c(area, "no data")
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[6]][which(all_meta_files[[6]]$Tumor.Normal.Classification=="Normal"), "Study_ID"])))
colnames(all_meta_files[[7]])
unique(all_meta_files[[7]]$Cell)
unique(all_meta_files[[7]]$Name)
unique(all_meta_files[[7]]$Age_in_Weeks)
all_meta_files[[7]]$Age_in_Weeks <- paste0("GW", all_meta_files[[7]]$Age_in_Weeks)
unique(all_meta_files[[7]]$Age_in_Weeks)
unique(all_meta_files[[7]]$RegionName)
unique(all_meta_files[[7]]$WGCNAcluster)
unique(all_meta_files[[7]]$Area)
unique(all_meta_files[[7]]$Laminae)
age <- c(age, paste(unique(all_meta_files[[7]]$Age_in_Weeks),collapse=", "))
cell_type <- c(cell_type, paste(unique(all_meta_files[[7]]$WGCNAcluster),collapse=", "))
area <- c(area, paste(unique(all_meta_files[[7]]$RegionName),collapse=", "))
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[7]]$Name)))
colnames(all_meta_files[[8]])
unique(all_meta_files[[8]]$cell)
unique(all_meta_files[[8]]$UMAP_2)
unique(all_meta_files[[8]]$cell_type)
unique(all_meta_files[[8]]$age)
unique(all_meta_files[[8]]$cell)
all_meta_files[[8]]$samples <- gsub(".*-","",all_meta_files[[8]]$cell)
unique(all_meta_files[[8]]$samples)
unique(all_meta_files[[8]]$age)
all_meta_files[[8]][which(all_meta_files[[8]]$age== "3rd trimester"), "samples"]
unique(all_meta_files[[8]][which(all_meta_files[[8]]$age== "3rd trimester"), "samples"])
unique(all_meta_files[[8]][which(all_meta_files[[8]]$age== "3rd trimester"), "cells"])
unique(all_meta_files[[8]][which(all_meta_files[[8]]$age== "3rd trimester"), "cell"])
unique(all_meta_files[[8]][which(all_meta_files[[8]]$age %in%  c("3rd trimester", "2nd trimester")), "samples"])
unique(all_meta_files[[8]][which(all_meta_files[[8]]$age %in%  c("3rd trimester", "2nd trimester")), "cell"])
unique(all_meta_files[[8]]$age)
unique(all_meta_files[[8]][which(all_meta_files[[8]]$age %in%  c("3rd trimester", "2nd trimester", "0-1 years" )), "cell"])
age <- c(age, paste(unique(all_meta_files[[8]]$age),collapse=", "))
cell_type <- c(cell_type, paste(unique(all_meta_files[[8]]$cell_type),collapse=", "))
area <- c(area, "no data")
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[8]][which(all_meta_files[[8]]$age %in%  c("3rd trimester", "2nd trimester", "0-1 years" )), "samples"])))
colnames(all_meta_files[[9]])
unique(all_meta_files[[9]]$Cell)
unique(all_meta_files[[9]]$Sample)
unique(all_meta_files[[9]]$Level1)
unique(all_meta_files[[9]]$Age)
unique(all_meta_files[[9]]$Clusters)
age <- c(age, paste(unique(all_meta_files[[9]]$Age),collapse=", "))
cell_type <- c(cell_type, paste(unique(all_meta_files[[9]]$Clusters),collapse=", "))
area <- c(area, "no data")
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[9]]$Sample)))
colnames(all_meta_files[[10]])
unique(all_meta_files[[10]]$cluster)
unique(all_meta_files[[10]]$age)
colnames(all_meta_files[[10]])
colnames(all_meta_files[[9]])
colnames(all_meta_files[[8]])
unique(all_meta_files[[10]]$cell)
all_meta_files[[10]]$samples <- gsub(".*-","",all_meta_files[[10]]$cell)
colnames(all_meta_files[[10]])
unique(all_meta_files[[10]]$cluster)
unique(all_meta_files[[10]]$sex)
age <- c(age, paste(unique(all_meta_files[[10]]$age),collapse=", "))
cell_type <- c(cell_type, "no data")
area <- c(area, "no data")
sex  <- c(sex, paste(unique(all_meta_files[[10]]$sex)))
num_samples <- c(num_samples, length(unique(all_meta_files[[10]][which(all_meta_files[[10]]$age %in%  c("3rd trimester", "2nd trimester", "0-1 years" )), "samples"])))
df_meta <- data.frame(names(all_meta_files), age, num_samples, sex, area, cell_type)
sex <- sex[1:9]
sex  <- c(sex, paste(unique(all_meta_files[[10]]$sex),collapse=", "))
df_meta <- data.frame(names(all_meta_files), age, num_samples, sex, area, cell_type)
View(df_meta)
View(df_meta)
names(all_meta_files)
View(df_meta)
colnames(df_meta)
colnames(df_meta) <- c("projects", "age", "num_samples", "sex", "area", "cell_type")
install.packages('tabulizer')
library(tabulizer)
install.packages("pdftools")
library(pdftools)
library(stringr)
library(stringi)
library(tidyr)
library(pdftools)
library(readxl)
main <- "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/outputs/"
input_path <- "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads"
all_meta_files <- list.files(input_path, pattern = "\\.tsv$", full.names = T)
all_meta_files <- lapply(all_meta_files, function(x) {
read.table(file = x,
sep = '\t',
header = TRUE)
})
names(all_meta_files) <- list.files(input_path, pattern = "\\.tsv$", full.names = F)
names(all_meta_files) <- str_remove_all(names(all_meta_files), "meta_")
names(all_meta_files) <- str_remove_all(names(all_meta_files), ".tsv")
############## vectors to summarize all info
age <- vector()
cell_type <- vector()
area <- vector()
sex  <- vector()
num_samples <- vector()
colnames(all_meta_files[[1]])
all_meta_files[[1]]$Samples <- stri_replace_last_fixed(all_meta_files[[1]]$Cell.Name, "_", "")
all_meta_files[[1]]$Samples <- stri_replace_last_fixed(all_meta_files[[1]]$Samples, "_", ".")
all_meta_files[[1]]$Samples <- gsub("\\..*", "", all_meta_files[[1]]$Samples)
all_meta_files[[1]]$Samples <- str_replace_all(all_meta_files[[1]]$Samples, c("_motor"="", "_PFC"="", "_V1"=""))
all_meta_files[[1]]$Samples <- str_replace_all(all_meta_files[[1]]$Samples, "gw", "GW")
age <- c(age, paste(unique(all_meta_files[[1]]$Age),collapse=", "))
cell_type <- c(cell_type, paste(unique(all_meta_files[[1]]$ConsensusCellType...Final),collapse=", "))
area <- c(area, paste(unique(all_meta_files[[1]]$Area),collapse=", "))
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[1]]$Samples)))
############## "Bhaduri_2021_whole_brain"
colnames(all_meta_files[[2]])
all_meta_files[[2]]$age <- paste0("GW", all_meta_files[[2]]$age)
age <- c(age, paste(unique(all_meta_files[[2]]$age),collapse=", "))
cell_type <- c(cell_type, paste(unique(all_meta_files[[2]]$cell_type),collapse=", "))
area <- c(area, paste(unique(all_meta_files[[2]]$area),collapse=", "))
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[2]]$individual)))
############## "Darmanis_15"
colnames(all_meta_files[[3]])
age <- c(age, paste(unique(all_meta_files[[3]]$GEO_Sample_age),collapse=", "))
cell_type <- c(cell_type, paste(unique(all_meta_files[[3]]$biosample_cell_type),collapse=", "))
area <- c(area, paste(unique(all_meta_files[[3]]$sample_category),collapse=", "))
sex  <- c(sex, "no data")
num_samples <- c(num_samples, "no data")
############## "Eze_2021"
colnames(all_meta_files[[4]])
all_meta_files[[4]]$Age_.Carnegie_Stage. <- paste0("GW", all_meta_files[[4]]$Age_.Carnegie_Stage.)
age <- c(age, paste(unique(all_meta_files[[4]]$Age_.Carnegie_Stage.),collapse=", "))
cell_type <- c(cell_type, "no data")
area <- c(area, paste(unique(all_meta_files[[4]]$Area_As_Annotated),collapse=", "))
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[4]]$Individual)))
############## "Han_2020"
colnames(all_meta_files[[5]])
age <- c(age, "no data")
cell_type <- c(cell_type,  paste(unique(all_meta_files[[5]][which(all_meta_files[[5]]$sample=="FetalBrain"), "cell_type"]),collapse=", "))
area <- c(area, paste(unique(all_meta_files[[5]]$sample),collapse=", "))
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[5]][which(all_meta_files[[5]]$organ=="Brain"), "donor"])))
############## "Muller_2018"
colnames(all_meta_files[[6]])
age <- c(age, "no data")
cell_type <- c(cell_type, paste(unique(all_meta_files[[6]][which(all_meta_files[[6]]$Tumor.Normal.Classification=="Normal"), "Cell.Type.Assignment"]),collapse=", "))
area <- c(area, "no data")
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[6]][which(all_meta_files[[6]]$Tumor.Normal.Classification=="Normal"), "Study_ID"])))
############## "Nowakowski_2017"
colnames(all_meta_files[[7]])
all_meta_files[[7]]$Age_in_Weeks <- paste0("GW", all_meta_files[[7]]$Age_in_Weeks)
age <- c(age, paste(unique(all_meta_files[[7]]$Age_in_Weeks),collapse=", "))
cell_type <- c(cell_type, paste(unique(all_meta_files[[7]]$WGCNAcluster),collapse=", "))
area <- c(area, paste(unique(all_meta_files[[7]]$RegionName),collapse=", "))
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[7]]$Name)))
############## "unknown"
colnames(all_meta_files[[8]])
all_meta_files[[8]]$samples <- gsub(".*-","",all_meta_files[[8]]$cell)
age <- c(age, paste(unique(all_meta_files[[8]]$age),collapse=", "))
cell_type <- c(cell_type, paste(unique(all_meta_files[[8]]$cell_type),collapse=", "))
area <- c(area, "no data")
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[8]][which(all_meta_files[[8]]$age %in%  c("3rd trimester", "2nd trimester", "0-1 years" )), "samples"])))
############## "van_Bruggen_2022"
colnames(all_meta_files[[9]])
age <- c(age, paste(unique(all_meta_files[[9]]$Age),collapse=", "))
cell_type <- c(cell_type, paste(unique(all_meta_files[[9]]$Clusters),collapse=", "))
area <- c(area, "no data")
sex  <- c(sex, "no data")
num_samples <- c(num_samples, length(unique(all_meta_files[[9]]$Sample)))
############## "Velmeshev_2022"
colnames(all_meta_files[[10]])
all_meta_files[[10]]$samples <- gsub(".*-","",all_meta_files[[10]]$cell)
age <- c(age, paste(unique(all_meta_files[[10]]$age),collapse=", "))
cell_type <- c(cell_type, "no data")
area <- c(area, "no data")
sex  <- c(sex, paste(unique(all_meta_files[[10]]$sex),collapse=", "))
num_samples <- c(num_samples, length(unique(all_meta_files[[10]][which(all_meta_files[[10]]$age %in%  c("3rd trimester", "2nd trimester", "0-1 years" )), "samples"])))
# unknown may be Velmeshev_2022
############## create df
df_meta <- data.frame(names(all_meta_files), age, num_samples, sex, area, cell_type)
colnames(df_meta) <- c("projects", "age", "num_samples", "sex", "area", "cell_type")
names(all_meta_files)
View(df_meta)
df_meta[which(df_meta$projects=="van_Bruggen_2022"), "area"] <- "forebrain"
View(df_meta)
suppl_files <- list.files(input_path, pattern = "\\.xlsx$", full.names = T)
suppl_files
suppl_files <- list()
suppl_files["Bhaduri_2021_neocortex"] <- read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Bhaduri_2021_suppl.xlsx",
sheet = 5)
suppl_files["Bhaduri_2021_whole_brain"] <- read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Bhaduri_2021_suppl.xlsx",
sheet = 1)
suppl_files <- list()
suppl_files <- append(suppl_files,
read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Bhaduri_2021_suppl.xlsx",
sheet = 5))
suppl_files <- append(suppl_files,
read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Bhaduri_2021_suppl.xlsx",
sheet = 1))
suppl_files <- list()
suppl_files <- append(suppl_files,
list(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Bhaduri_2021_suppl.xlsx",
sheet = 5)))
suppl_files <- append(suppl_files,
list(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Bhaduri_2021_suppl.xlsx",
sheet = 1)))
suppl_files <- append(suppl_files,
list(pdf_data("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Darmanis_15_suppl.pdf")))
pdf_data("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Darmanis_15_suppl.pdf"))
pdf_data("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Darmanis_15_suppl.pdf")
pdf_data("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Darmanis_15_suppl.pdf")[[18]]
suppl_files <- list()
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Bhaduri_2021_suppl.xlsx",
sheet = 5))))
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Bhaduri_2021_suppl.xlsx",
sheet = 1))))
suppl_files <- append(suppl_files,
list(as.data.frame(pdf_data("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Darmanis_15_suppl.pdf")[[18]])))
suppl_files[[3]]
suppl_files[[3]]$text
suppl_files[[3]] <- NULL
suppl_files <- append(suppl_files,
list(as.data.frame(pdf_text("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Darmanis_15_suppl.pdf")[[18]])))
suppl_files[[3]]
suppl_files[[3]][1,]
suppl_files[[3]] <- NULL
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Darmanis_15_suppl.xlsx",
sheet = 1))))
suppl_files[[3]] <- NULL
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Darmanis_15_suppl.xlsx",
sheet = 1, col_names = T))))
suppl_files[[3]]
suppl_files[[3]] <- NULL
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Darmanis_15_suppl.xlsx",
sheet = 1, col_names = T, skip=1))))
names(all_meta_files)
View(df_meta)
View(df_meta)
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Eze_2021_suppl.xlsx",
sheet = 6, col_names = T))))
suppl_files[[4]] <- NULL
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Eze_2021_suppl.xlsx",
sheet = 6, col_names = T, skip=1))))
suppl_files[[4]] <- NULL
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Eze_2021_suppl.xlsx",
sheet = 6))))
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Han_2020_suppl.xlsx",
sheet = 2))))
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Muller_2018_suppl.xlsx"))))
View(df_meta)
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Nowakowski_2017_suppl.xlsx",
sheet = 2))))
list.files(input_path, pattern = "\\.xlsx$")
names(suppl_files) <- list.files(input_path, pattern = "\\.xlsx$")
names(suppl_files) <- str_remove_all(names(suppl_files), "meta_")
names(suppl_files) <- str_remove_all(names(suppl_files), ".xlsx")
names(suppl_files) <- c("meta_Bhaduri_2021_neocortex_suppl.xlsx", list.files(input_path, pattern = "\\.xlsx$"))
names(suppl_files) <- str_remove_all(names(suppl_files), "meta_")
names(suppl_files) <- str_remove_all(names(suppl_files), "_suppl.xlsx")
names(suppl_files)[2] <- paste0(names(suppl_files)[2], "_whole_brain")
names(suppl_files)
View(df_meta)
colnames(suppl_files[["Eze_2021"]])
suppl_files[["Eze_2021"]][1:10,]
unique(suppl_files[["Eze_2021"]]$Individual)
unique(suppl_files[["Eze_2021"]]$`Cell Type`)
df_meta[which(df_meta$projects=="Eze_2021"), "cell_type"] <- paste(unique(suppl_files[["Eze_2021"]]$`Cell Type`), collapse = ", ")
df_meta
"no_data" %in% df_meta
View(df_meta)
colnames(suppl_files[["Darmanis_2015"]])
names(suppl_files) <- c("meta_Bhaduri_2021_neocortex_suppl.xlsx", list.files(input_path, pattern = "\\.xlsx$"))
names(suppl_files) <- str_remove_all(names(suppl_files), "meta_")
names(suppl_files) <- str_remove_all(names(suppl_files), "_suppl.xlsx")
names(suppl_files)[2] <- paste0(names(suppl_files)[2], "_whole_brain")
names(all_meta_files) <- list.files(input_path, pattern = "\\.tsv$", full.names = F)
names(all_meta_files) <- str_remove_all(names(all_meta_files), "meta_")
names(all_meta_files) <- str_remove_all(names(all_meta_files), ".tsv")
df_meta <- data.frame(names(all_meta_files), age, num_samples, sex, area, cell_type)
colnames(df_meta) <- c("projects", "age", "num_samples", "sex", "area", "cell_type")
df_meta[which(df_meta$projects=="van_Bruggen_2022"), "area"] <- "forebrain"
View(df_meta)
colnames(suppl_files[["Darmanis_2015"]])
suppl_files[["Darmanis_2015"]][1:10, ]
View(df_meta)
df_meta[which(df_meta$projects=="Darmanis_2015"), "num_samples"] <-length(unique(suppl_files[["Darmanis_2015"]]$`Experiment name`))
df_meta[which(df_meta$projects=="Eze_2021"), "cell_type"] <- paste(unique(suppl_files[["Eze_2021"]]$`Cell Type`), collapse = ", ")
colnames(suppl_files[["Han_2020"]])
unique(suppl_files[["Han_2020"]]$Age)
suppl_files[["Han_2020"]][which(is.na(suppl_files[["Han_2020"]]$Age)), ]
suppl_files[["Han_2020"]][1,]
names(suppl_files[["Han_2020"]])[names(suppl_files[["Han_2020"]]) == 'Source of sample'] <- 'Abortion/DCD(Donation after Cardiac Death)/Operation'
names(suppl_files[["Han_2020"]])[names(suppl_files[["Han_2020"]]) == '...6'] <- 'Cause of death'
colnames(suppl_files[["Han_2020"]])
suppl_files[["Han_2020"]][1,]
suppl_files[["Han_2020"]][1,] <- NULL
suppl_files[["Han_2020"]][1,]
suppl_files[["Han_2020"]] <- suppl_files[["Han_2020"]][2,]
suppl_files <- list()
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Bhaduri_2021_suppl.xlsx",
sheet = 5))))
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Bhaduri_2021_suppl.xlsx",
sheet = 1))))
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Darmanis_15_suppl.xlsx",
sheet = 1, col_names = T, skip=1))))
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Darmanis_2015_suppl.xlsx",
sheet = 1, col_names = T, skip=1))))
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Eze_2021_suppl.xlsx",
sheet = 6))))
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Han_2020_suppl.xlsx",
sheet = 2, skip = 2))))
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Muller_2018_suppl.xlsx"))))
suppl_files <- append(suppl_files,
list(as.data.frame(read_excel("/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/UCSC_downloads/meta_Nowakowski_2017_suppl.xlsx",
sheet = 2))))
names(suppl_files) <- c("meta_Bhaduri_2021_neocortex_suppl.xlsx", list.files(input_path, pattern = "\\.xlsx$"))
names(suppl_files) <- str_remove_all(names(suppl_files), "meta_")
names(suppl_files) <- str_remove_all(names(suppl_files), "_suppl.xlsx")
names(suppl_files)[2] <- paste0(names(suppl_files)[2], "_whole_brain")
df_meta[which(df_meta$projects=="Darmanis_2015"), "num_samples"] <-length(unique(suppl_files[["Darmanis_2015"]]$`Experiment name`))
df_meta[which(df_meta$projects=="Eze_2021"), "cell_type"] <- paste(unique(suppl_files[["Eze_2021"]]$`Cell Type`), collapse = ", ")
suppl_files[["Han_2020"][1:10,]
suppl_files[["Han_2020"]][1:10,]
colnames(suppl_files[["Han_2020"]]) <- c("Tissues/Cell lines", "Donor",
"Age", "Gender",
"Abortion/DCD(Donation after Cardiac Death)/Operation", "Cause of death",
"Medical history", "Sampling location",
"Dissociation reagent", "Reagent concentration",
"Enzymatic digestion time" )
View(df_meta)
df_meta[which(df_meta$projects=="Han_2020"), "cell_type"] <- paste(unique(suppl_files[["Han_2020"]]$Age), collapse = ", ")
df_meta <- data.frame(names(all_meta_files), age, num_samples, sex, area, cell_type)
colnames(df_meta) <- c("projects", "age", "num_samples", "sex", "area", "cell_type")
# time to scavenge for extra metadata
# Muller actually does not have fetal data it seems -> discuss with Anagha
# no additional metadata for Van Bruggen, but it is mentioned in the paper that the samples are from the forebrain
df_meta[which(df_meta$projects=="van_Bruggen_2022"), "area"] <- "forebrain"
df_meta[which(df_meta$projects=="Darmanis_2015"), "num_samples"] <-length(unique(suppl_files[["Darmanis_2015"]]$`Experiment name`))
df_meta[which(df_meta$projects=="Eze_2021"), "cell_type"] <- paste(unique(suppl_files[["Eze_2021"]]$`Cell Type`), collapse = ", ")
df_meta[which(df_meta$projects=="Han_2020"), "age"] <- paste(unique(suppl_files[["Han_2020"]]$Age), collapse = ", ")
unique(suppl_files[["Han_2020"]]$Gender)
df_meta[which(df_meta$projects=="Han_2020"), "sex"] <- paste(unique(suppl_files[["Han_2020"]]$Gender), collapse = ", ")
unique(suppl_files[["Han_2020"]][which(suppl_files[["Han_2020"]]$`Tissues/Cell lines`=="Fetal Brain"),])
unique(suppl_files[["Han_2020"]][which("Fetal Brain" %in% suppl_files[["Han_2020"]]$`Tissues/Cell lines`),])
suppl_files[["Han_2020"]]
colnames(suppl_files[["Muller_2018"]])
df_meta[which(df_meta$projects=="Muller_2018"),]
df_meta[which(df_meta$projects=="Muller_2018"), "age"] <- paste(unique(suppl_files[["Muller_2018"]]$Age), collapse = ", ")
View(df_meta)
df_meta[which(df_meta$projects=="Muller_2018"), "sex"] <- paste(unique(suppl_files[["Muller_2018"]]$Gender), collapse = ", ")
df_meta[which(df_meta$projects=="Muller_2018"), "age"] <- paste("YEARS", df_meta[which(df_meta$projects=="Muller_2018"), "age"], sep = " ")
names(suppl_files)
colnames(suppl_files[["Nowakowski_2017"]])
write.csv(df_meta, "/Users/aurazelco/Desktop/Lund_MSc/Thesis/data/UCSC/meta_summary.csv")
View(df_meta)
library(Seurat)
library(SeuratObject)
all_expr_files <- list.files(input_path, pattern = "\\.tsv.gz$", full.names = T)
all_expr_files <- lapply(all_expr_files, function(x) {
freade(file = x)
})
all_expr_files <- lapply(all_expr_files, function(x) {
fread(file = x)
})
library(Seurat)
library(SeuratObject)
require(data.table)
all_expr_files
all_expr_files <- list.files(input_path, pattern = "\\.gz$", full.names = T)
all_expr_files <- lapply(all_expr_files, function(x) {
fread(file = x)
})
